package meowmel.gtqtspace.common.metatileentities.multiblock.standard.spaceElevator;

import codechicken.lib.render.CCRenderState;
import codechicken.lib.render.pipeline.IVertexOperation;
import codechicken.lib.vec.Matrix4;
import gregtech.api.capability.IEnergyContainer;
import gregtech.api.capability.IOpticalComputationHatch;
import gregtech.api.capability.IOpticalComputationProvider;
import gregtech.api.capability.impl.EnergyContainerList;
import gregtech.api.gui.GuiTextures;
import gregtech.api.gui.ModularUI;
import gregtech.api.gui.widgets.AdvancedTextWidget;
import gregtech.api.gui.widgets.ClickButtonWidget;
import gregtech.api.gui.widgets.ImageCycleButtonWidget;
import gregtech.api.gui.widgets.ImageWidget;
import gregtech.api.metatileentity.MetaTileEntity;
import gregtech.api.metatileentity.interfaces.IGregTechTileEntity;
import gregtech.api.metatileentity.multiblock.IMultiblockPart;
import gregtech.api.metatileentity.multiblock.MultiblockAbility;
import gregtech.api.metatileentity.multiblock.MultiblockDisplayText;
import gregtech.api.metatileentity.multiblock.MultiblockWithDisplayBase;
import gregtech.api.pattern.BlockPattern;
import gregtech.api.pattern.FactoryBlockPattern;
import gregtech.api.pattern.PatternMatchContext;
import gregtech.api.util.TextComponentUtil;
import gregtech.client.renderer.ICubeRenderer;
import gregtech.client.renderer.texture.Textures;
import gregtech.client.utils.TooltipHelper;
import keqing.gtqtcore.api.blocks.impl.WrappedIntTired;
import meowmel.gtqtspace.api.multiblock.GTQTSMultiblockAbility;
import meowmel.gtqtspace.api.multiblock.ISpaceElevatorProvider;
import meowmel.gtqtspace.api.multiblock.ISpaceElevatorReceiver;
import meowmel.gtqtspace.api.predicate.TiredTraceabilityPredicate;
import meowmel.gtqtspace.api.utils.GTQTSUtil;
import meowmel.gtqtspace.client.textures.GTQTSTextures;
import meowmel.gtqtspace.common.block.GTQTSMetaBlocks;
import meowmel.gtqtspace.common.block.blocks.GTQTSpaceElevatorCasing;
import meowmel.gtqtspace.common.metatileentities.GTQTSMetaTileEntities;
import meowmel.gtqtspace.world.Teleporter.WorldTeleporter;
import net.minecraft.client.resources.I18n;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.entity.player.EntityPlayerMP;
import net.minecraft.item.ItemStack;
import net.minecraft.nbt.NBTTagCompound;
import net.minecraft.network.PacketBuffer;
import net.minecraft.util.EnumFacing;
import net.minecraft.util.ResourceLocation;
import net.minecraft.util.text.ITextComponent;
import net.minecraft.util.text.TextFormatting;
import net.minecraft.world.World;
import net.minecraftforge.fml.common.FMLCommonHandler;
import net.minecraftforge.fml.relauncher.Side;
import net.minecraftforge.fml.relauncher.SideOnly;

import javax.annotation.Nonnull;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.List;
import java.util.concurrent.ConcurrentHashMap;

import static gregtech.api.unification.material.Materials.Naquadah;
import static gregtech.api.util.RelativeDirection.*;

public class MetaTileEntitySpaceElevator extends MultiblockWithDisplayBase {
    private final Collection<ISpaceElevatorReceiver> spaceElevatorReceivers = ConcurrentHashMap.newKeySet();
    protected IOpticalComputationProvider computationProvider;
    protected IEnergyContainer energyContainer;
    protected int motorTier = 0;
    private boolean isExtended = false;

    public MetaTileEntitySpaceElevator(ResourceLocation metaTileEntityId) {
        super(metaTileEntityId);
    }


    @Override
    public MetaTileEntity createMetaTileEntity(IGregTechTileEntity iGregTechTileEntity) {
        return new MetaTileEntitySpaceElevator(metaTileEntityId);
    }

    @Override
    public void update() {
        super.update();
        if (!isStructureFormed())
            this.spaceElevatorReceivers.forEach(ISpaceElevatorReceiver::sentWorkingDisabled);
    }

    @Override
    protected void updateFormedValid() {
        if (!this.spaceElevatorReceivers.isEmpty()) {
            if (!checkModules()) {
                invalidateStructure();
            }
        }
        if (this.getOffsetTimer() % 20 == 0) {
            spaceElevatorReceivers.clear();
            for (ISpaceElevatorProvider receiver : getSpaceElevatorProviders()) {
                if (receiver.getModule() != null && receiver.getModule().isStructureFormed())
                    this.spaceElevatorReceivers.add(receiver.getModule().getSpaceElevatorReceiver());
            }
        }
    }

    @Override
    protected BlockPattern createStructurePattern() {
        if (!this.isExtended) {
            return FactoryBlockPattern.start(RIGHT, DOWN, FRONT)
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "               FF FF               ", "               AAAAA               ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "               D   D               ", "            FFFFF FFFFF            ", "            AAAAAAAAAAA            ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "            DDDDE EDDDD            ", "          FFFFFFF FFFFFFF          ", "          AAAAAAAAAAAAAAA          ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "          DD   DE ED   DD          ", "         FFFFFFD   DFFFFFF         ", "        AAAAAAAAAAAAAAAAAAA        ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               D   D               ", "         FFF           FFF         ", "       AAAAAAAAAAAAAAAAAAAAA       ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "      AAAAAAAAAAAAAAAAAAAAAAA      ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "     AAAAAAAAAAAAAAAAAAAAAAAAA     ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "              HDE EDH              ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "    AAAAAAAAAAAIAIAIAAAAAAAAAAA    ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "            HH DE ED HH            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   AAAAAAAAAAAA     AAAAAAAAAAAA   ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "         E               E         ", "         EHH           HHE         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "   FF    E               E    FF   ", "   AAAAAAAAAAAA     AAAAAAAAAAAA   ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "          E             E          ", "          E             E          ", "          E             E          ", "          E             E          ", "          E             E          ", "         HE             EH         ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   D                           D   ", "  FFF          F F F          FFF  ", "  AAAAAAAAAAAAA     AAAAAAAAAAAAA  ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "           E           E           ", "           E           E           ", "           E           E           ", "           E           E           ", "           E           E           ", "                                   ", "                                   ", "         H               H         ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   D                           D   ", "  FFF          F F F          FFF  ", "  AAAAAAAAAAAAA     AAAAAAAAAAAAA  ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             HH     HH             ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "        H                 H        ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "  D                             D  ", " FFF          FFFFFFF          FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "            HE       EH            ", "             E       E             ", "             E       E             ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "        H                 H        ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "  D                             D  ", " FFF         FFFFFFFFF         FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                FFF                ", "                 E                 ", "                 E                 ", "                 E                 ", "                 E                 ", "                 E                 ", "               F   F               ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "            H         H            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "                                   ", "                                   ", "       H                   H       ", "                                   ", "                                   ", "                                   ", "                                   ", "                XXX                ", "                X~X                ", "  D             XXX             D  ", " FFF        FFFFFFFFFFF        FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("               F D F               ", "                 D                 ", "                 D                 ", "                 D                 ", "                 D                 ", "                 D                 ", "              F  D  F              ", "                 D                 ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "           DD    D    DD           ", "           D     D     D           ", "           D     D     D           ", "           D   F D F   D           ", "           D     C     D           ", "           D     C     D           ", "           D     C     D           ", "           D     C     D           ", "          DD     C     DD          ", "          D      C      D          ", "          D      C      D          ", "          D      C      D          ", "         DD      C      DD         ", "         D     FDCDF     D         ", "         D      DCD      D         ", "        DD      DCD      DD        ", "        D       DCD       D        ", "        D       DCD       D        ", "       DD      DDCDD      DD       ", "       D       D C D       D       ", "       D       D C D       D       ", "      DD       D C D       DD      ", "      D        D C D        D      ", "     DD        XDCDX        DD     ", "    DD         XDCDX         DD    ", " DDDD          XDCDX          DDDD ", "FFFD      FFFFFDDDDDFFFFF      DFFF", "AAAAAAAI    AAAXXXXXAAA    IAAAAAAA")
                    .aisle("              F     F              ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             F       F             ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "           EE         EE           ", "           EE         EE           ", "           E           E           ", "           E           E           ", "           E  F     F  E           ", "           E           E           ", "           E           E           ", "           E           E           ", "          EE           EE          ", "          EE           EE          ", "          E             E          ", "          E             E          ", "         EE             EE         ", "         EE             EE         ", "         E    FD   DF    E         ", "        EE     D   D     EE        ", "        EE     D   D     EE        ", "        E      D   D      E        ", "       EE      D   D      EE       ", "       EE      D   D      EE       ", "       E                   E       ", "      EE                   EE      ", "      EE                   EE      ", "     EE                     EE     ", "    EEE       XD   DX       EEE    ", "   EEE        XD   DX        EEE   ", "  EE          XD   DX          EE  ", "FFF         FFFDDDDDFFF         FFF", "AAAAAAAA    AAAXXXXXAAA    AAAAAAAA")
                    .aisle("              FD   DF              ", "              ED   DE              ", "              ED   DE              ", "              ED   DE              ", "              ED   DE              ", "              ED   DE              ", "             F D   D F             ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D B D               ", "              FD - DF              ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "              FC - CF              ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "              XC - CX              ", "              XC - CX              ", "              XC - CX              ", "          FFFFFDDDDDFFFFF          ", "AAAAAAAI    AAAXXXXXAAA    IAAAAAAA")
                    .aisle("              F     F              ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             F       F             ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "           EE         EE           ", "           EE         EE           ", "           E           E           ", "           E           E           ", "           E  F     F  E           ", "           E           E           ", "           E           E           ", "           E           E           ", "          EE           EE          ", "          EE           EE          ", "          E             E          ", "          E             E          ", "         EE             EE         ", "         EE             EE         ", "         E    FD   DF    E         ", "        EE     D   D     EE        ", "        EE     D   D     EE        ", "        E      D   D      E        ", "       EE      D   D      EE       ", "       EE      D   D      EE       ", "       E                   E       ", "      EE                   EE      ", "      EE                   EE      ", "     EE                     EE     ", "    EEE       XD   DX       EEE    ", "   EEE        XD   DX        EEE   ", "  EE          XD   DX          EE  ", "FFF         FFFDDDDDFFF         FFF", "AAAAAAAA    AAAXXXXXAAA    AAAAAAAA")
                    .aisle("               F D F               ", "                 D                 ", "                 D                 ", "                 D                 ", "                 D                 ", "                 D                 ", "              F  D  F              ", "                 D                 ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "           DD    D    DD           ", "           D     D     D           ", "           D     D     D           ", "           D   F D F   D           ", "           D     C     D           ", "           D     C     D           ", "           D     C     D           ", "           D     C     D           ", "          DD     C     DD          ", "          D      C      D          ", "          D      C      D          ", "          D      C      D          ", "         DD      C      DD         ", "         D     FDCDF     D         ", "         D      DCD      D         ", "        DD      DCD      DD        ", "        D       DCD       D        ", "        D       DCD       D        ", "       DD      DDCDD      DD       ", "       D       D C D       D       ", "       D       D C D       D       ", "      DD       D C D       DD      ", "      D        D C D        D      ", "     DD        XDCDX        DD     ", "    DD         XDCDX         DD    ", " DDDD          XDCDX          DDDD ", "FFFD      FFFFFDDDDDFFFFF      DFFF", "AAAAAAAI    AAAXXXXXAAA    IAAAAAAA")
                    .aisle("                FFF                ", "                 E                 ", "                 E                 ", "                 E                 ", "                 E                 ", "                 E                 ", "               F   F               ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "            H         H            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "                                   ", "                                   ", "       H                   H       ", "                                   ", "                                   ", "                                   ", "                                   ", "                XXX                ", "                XXX                ", "  D             XXX             D  ", " FFF        FFFFFFFFFFF        FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "            HE       EH            ", "             E       E             ", "             E       E             ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "        H                 H        ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "  D                             D  ", " FFF         FFFFFFFFF         FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             HH     HH             ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "        H                 H        ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "  D                             D  ", " FFF          FFFFFFF          FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "           E           E           ", "           E           E           ", "           E           E           ", "           E           E           ", "           E           E           ", "                                   ", "                                   ", "         H               H         ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   D                           D   ", "  FFF          F F F          FFF  ", "  AAAAAAAAAAAAA     AAAAAAAAAAAAA  ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "          E             E          ", "          E             E          ", "          E             E          ", "          E             E          ", "          E             E          ", "         HE             EH         ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   D                           D   ", "  FFF          F F F          FFF  ", "  AAAAAAAAAAAAA     AAAAAAAAAAAAA  ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "         E               E         ", "         EHH           HHE         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "   FF    E               E    FF   ", "   AAAAAAAAAAAA     AAAAAAAAAAAA   ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "            HH DE ED HH            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   AAAAAAAAAAAA     AAAAAAAAAAAA   ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "              HDE EDH              ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "    AAAAAAAAAAAIAIAIAAAAAAAAAAA    ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "     AAAAAAAAAAAAAAAAAAAAAAAAA     ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "      AAAAAAAAAAAAAAAAAAAAAAA      ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               D   D               ", "         FFF           FFF         ", "       AAAAAAAAAAAAAAAAAAAAA       ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "          DD   DE ED   DD          ", "         FFFFFFD   DFFFFFF         ", "        AAAAAAAAAAAAAAAAAAA        ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "            DDDDE EDDDD            ", "          FFFFFFF FFFFFFF          ", "          AAAAAAAAAAAAAAA          ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "               D   D               ", "            FFFFF FFFFF            ", "            AAAAAAAAAAA            ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "               FF FF               ", "               AAAAA               ")
                    .where(' ', any())
                    .where('-', air())
                    .where('~', selfPredicate())
                    .where('D', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING)))
                    .where('F', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.INTERNAL_STRUCTURE)))
                    .where('E', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.SUPPORT_STRUCTURE)))
                    .where('A', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.FLOOR)))
                    .where('B', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.CABLE_CASING)))
                    .where('H', frames(Naquadah))
                    .where('X', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING))
                            .or(abilities(MultiblockAbility.INPUT_ENERGY, MultiblockAbility.INPUT_LASER).setExactLimit(1))
                            .or(abilities(MultiblockAbility.COMPUTATION_DATA_RECEPTION).setExactLimit(1)))
                    .where('C', TiredTraceabilityPredicate.CP_SE_CASING.get())
                    .where('I', metaTileEntities(GTQTSMetaTileEntities.ELEVATOR_PROVIDER_HATCH))
                    .build();
        } else {
            return FactoryBlockPattern.start(RIGHT, DOWN, FRONT)
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                    FFFFFFF                    ", "                    AIAIAIA                    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   FF     FF                   ", "                 AAAA     AAAA                 ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   FF     FF                   ", "              AAAAAAA     AAAAAAA              ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   FFF F FFF                   ", "            AAAAAAAAAA   AAAAAAAAAA            ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFF F FFFF                  ", "          AAAA   AAAAA   AAAAA   AAAA          ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFF F FFFF                  ", "        AAAA     AAAAA   AAAAA     AAAA        ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFFFFFFFFF                  ", "       AAA      AAAAAAAAAAAAAAA      AAA       ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                     D   D                     ", "                  FFFFF FFFFF                  ", "      AAA       AAAAAAAAAAAAAAA       AAA      ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  DDDDE EDDDD                  ", "                FFFFFFF FFFFFFF                ", "     AAA        AAAAAAAAAAAAAAA        AAA     ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                DD   DE ED   DD                ", "               FFFFFFD   DFFFFFF               ", "     AA       AAAAAAAAAAAAAAAAAAA       AA     ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     D   D                     ", "               FFF           FFF               ", "    AA       AAAAAAAAAAAAAAAAAAAAA       AA    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "    AA      AAAAAAAAAAAAAAAAAAAAAAA      AA    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "   AA      AAAAAAAAAAAAAAAAAAAAAAAAA      AA   ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                    HDE EDH                    ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "   AA     AAAAAAAAAAAIAIAIAAAAAAAAAAA     AA   ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                  HH DE ED HH                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "  AA     AAAAAAAAAAAA     AAAAAAAAAAAA     AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "               E               E               ", "               EHH           HHE               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "         FF    E               E    FF         ", "  AA     AAAAAAAAAAAA     AAAAAAAAAAAA     AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                E             E                ", "                E             E                ", "                E             E                ", "                E             E                ", "                E             E                ", "               HE             EH               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "         D                           D         ", "        FFF          F F F          FFF        ", "  AA  AAAAAAAAAAAAAAA     AAAAAAAAAAAAAAA  AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                                               ", "                                               ", "               H               H               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "         D                           D         ", "        FFF          F F F          FFF        ", " AAAAAAAAAAAAAAAAAAAA     AAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   HH     HH                   ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "              H                 H              ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "        D                             D        ", "    FFFFFF          FFFFFFF          FFFFFF    ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                  HE       EH                  ", "                   E       E                   ", "                   E       E                   ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "              H                 H              ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "        D                             D        ", " FFFFFFFFF         FFFFFFFFF         FFFFFFFFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                      FFF                      ", "                       E                       ", "                       E                       ", "                       E                       ", "                       E                       ", "                       E                       ", "                     F   F                     ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                  H         H                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                                               ", "                                               ", "             H                   H             ", "                                               ", "                                               ", "                                               ", "                                               ", "                      XXX                      ", "                      X~X                      ", "        D             XXX             D        ", "FFFFFFFFFF        FFFFFFFFFFF        FFFFFFFFFF", "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")
                    .aisle("                     F D F                     ", "                       D                       ", "                       D                       ", "                       D                       ", "                       D                       ", "                       D                       ", "                    F  D  F                    ", "                       D                       ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                 DD    D    DD                 ", "                 D     D     D                 ", "                 D     D     D                 ", "                 D   F D F   D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                DD     C     DD                ", "                D      C      D                ", "                D      C      D                ", "                D      C      D                ", "               DD      C      DD               ", "               D     FDCDF     D               ", "               D      DCD      D               ", "              DD      DCD      DD              ", "              D       DCD       D              ", "              D       DCD       D              ", "             DD      DDCDD      DD             ", "             D       D C D       D             ", "             D       D C D       D             ", "            DD       D C D       DD            ", "            D        D C D        D            ", "           DD        XDCDX        DD           ", "          DD         XDCDX         DD          ", "       DDDD          XDCDX          DDDD       ", "F  FFFFFFD      FFFFFDDDDDFFFFF      DFFFFFF  F", "I  AAAAAAAAAAI    AAAXXXXXAAA    IAAAAAAAAAA  I")
                    .aisle("                    F     F                    ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   F       F                   ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                 EE         EE                 ", "                 EE         EE                 ", "                 E           E                 ", "                 E           E                 ", "                 E  F     F  E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                EE           EE                ", "                EE           EE                ", "                E             E                ", "                E             E                ", "               EE             EE               ", "               EE             EE               ", "               E    FD   DF    E               ", "              EE     D   D     EE              ", "              EE     D   D     EE              ", "              E      D   D      E              ", "             EE      D   D      EE             ", "             EE      D   D      EE             ", "             E                   E             ", "            EE                   EE            ", "            EE                   EE            ", "           EE                     EE           ", "          EEE       XD   DX       EEE          ", "         EEE        XD   DX        EEE         ", "        EE          XD   DX          EE        ", "F     FFF         FFFDDDDDFFF         FFF     F", "A     AAAAAAAA    AAAXXXXXAAA    AAAAAAAA     A")
                    .aisle("                    FD   DF                    ", "                    ED   DE                    ", "                    ED   DE                    ", "                    ED   DE                    ", "                    ED   DE                    ", "                    ED   DE                    ", "                   F D   D F                   ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D B D                     ", "                    FD - DF                    ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                    FC - CF                    ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                    XC - CX                    ", "                    XC - CX                    ", "                    XC - CX                    ", "F  FFFF         FFFFFDDDDDFFFFF         FFFF  F", "I     AAAAAAAI    AAAXXXXXAAA    IAAAAAAA     I")
                    .aisle("                    F     F                    ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   F       F                   ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                 EE         EE                 ", "                 EE         EE                 ", "                 E           E                 ", "                 E           E                 ", "                 E  F     F  E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                EE           EE                ", "                EE           EE                ", "                E             E                ", "                E             E                ", "               EE             EE               ", "               EE             EE               ", "               E    FD   DF    E               ", "              EE     D   D     EE              ", "              EE     D   D     EE              ", "              E      D   D      E              ", "             EE      D   D      EE             ", "             EE      D   D      EE             ", "             E                   E             ", "            EE                   EE            ", "            EE                   EE            ", "           EE                     EE           ", "          EEE       XD   DX       EEE          ", "         EEE        XD   DX        EEE         ", "        EE          XD   DX          EE        ", "F     FFF         FFFDDDDDFFF         FFF     F", "A     AAAAAAAA    AAAXXXXXAAA    AAAAAAAA     A")
                    .aisle("                     F D F                     ", "                       D                       ", "                       D                       ", "                       D                       ", "                       D                       ", "                       D                       ", "                    F  D  F                    ", "                       D                       ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                 DD    D    DD                 ", "                 D     D     D                 ", "                 D     D     D                 ", "                 D   F D F   D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                DD     C     DD                ", "                D      C      D                ", "                D      C      D                ", "                D      C      D                ", "               DD      C      DD               ", "               D     FDCDF     D               ", "               D      DCD      D               ", "              DD      DCD      DD              ", "              D       DCD       D              ", "              D       DCD       D              ", "             DD      DDCDD      DD             ", "             D       D C D       D             ", "             D       D C D       D             ", "            DD       D C D       DD            ", "            D        D C D        D            ", "           DD        XDCDX        DD           ", "          DD         XDCDX         DD          ", "       DDDD          XDCDX          DDDD       ", "F  FFFFFFD      FFFFFDDDDDFFFFF      DFFFFFF  F", "I  AAAAAAAAAAI    AAAXXXXXAAA    IAAAAAAAAAA  I")
                    .aisle("                      FFF                      ", "                       E                       ", "                       E                       ", "                       E                       ", "                       E                       ", "                       E                       ", "                     F   F                     ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                  H         H                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                                               ", "                                               ", "             H                   H             ", "                                               ", "                                               ", "                                               ", "                                               ", "                      XXX                      ", "                      XXX                      ", "        D             XXX             D        ", "FFFFFFFFFF        FFFFFFFFFFF        FFFFFFFFFF", "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                  HE       EH                  ", "                   E       E                   ", "                   E       E                   ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "              H                 H              ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "        D                             D        ", " FFFFFFFFF         FFFFFFFFF         FFFFFFFFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   HH     HH                   ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "              H                 H              ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "        D                             D        ", "    FFFFFF          FFFFFFF          FFFFFF    ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                                               ", "                                               ", "               H               H               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "         D                           D         ", "        FFF          F F F          FFF        ", " AAAAAAAAAAAAAAAAAAAA     AAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                E             E                ", "                E             E                ", "                E             E                ", "                E             E                ", "                E             E                ", "               HE             EH               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "         D                           D         ", "        FFF          F F F          FFF        ", "  AA  AAAAAAAAAAAAAAA     AAAAAAAAAAAAAAA  AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "               E               E               ", "               EHH           HHE               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "         FF    E               E    FF         ", "  AA     AAAAAAAAAAAA     AAAAAAAAAAAA     AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                  HH DE ED HH                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "  AA     AAAAAAAAAAAA     AAAAAAAAAAAA     AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                    HDE EDH                    ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "   AA     AAAAAAAAAAAIAIAIAAAAAAAAAAA     AA   ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "   AA      AAAAAAAAAAAAAAAAAAAAAAAAA      AA   ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "    AA      AAAAAAAAAAAAAAAAAAAAAAA      AA    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     D   D                     ", "               FFF           FFF               ", "    AA       AAAAAAAAAAAAAAAAAAAAA       AA    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                DD   DE ED   DD                ", "               FFFFFFD   DFFFFFF               ", "     AA       AAAAAAAAAAAAAAAAAAA       AA     ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  DDDDE EDDDD                  ", "                FFFFFFF FFFFFFF                ", "     AAA        AAAAAAAAAAAAAAA        AAA     ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                     D   D                     ", "                  FFFFF FFFFF                  ", "      AAA       AAAAAAAAAAAAAAA       AAA      ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFFFFFFFFF                  ", "       AAA      AAAAAAAAAAAAAAA      AAA       ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFF F FFFF                  ", "        AAAA     AAAAA   AAAAA     AAAA        ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFF F FFFF                  ", "          AAAA   AAAAA   AAAAA   AAAA          ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   FFF F FFF                   ", "            AAAAAAAAAA   AAAAAAAAAA            ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   FF     FF                   ", "              AAAAAAA     AAAAAAA              ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   FF     FF                   ", "                 AAAA     AAAA                 ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                    FFFFFFF                    ", "                    AIAIAIA                    ")
                    .where(' ', any())
                    .where('-', air())
                    .where('~', selfPredicate())
                    .where('D', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING)))
                    .where('F', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.INTERNAL_STRUCTURE)))
                    .where('E', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.SUPPORT_STRUCTURE)))
                    .where('A', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.FLOOR)))
                    .where('B', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.CABLE_CASING)))
                    .where('H', frames(Naquadah))
                    .where('X', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING))
                            .or(abilities(MultiblockAbility.INPUT_ENERGY, MultiblockAbility.INPUT_LASER).setExactLimit(1))
                            .or(abilities(MultiblockAbility.COMPUTATION_DATA_RECEPTION).setExactLimit(1)))
                    .where('C', TiredTraceabilityPredicate.CP_SE_CASING.get())
                    .where('I', metaTileEntities(GTQTSMetaTileEntities.ELEVATOR_PROVIDER_HATCH))
                    .build();
        }
    }

    @Override
    public boolean hasMaintenanceMechanics() {
        return false;
    }

    @Override
    public ICubeRenderer getBaseTexture(IMultiblockPart iMultiblockPart) {
        return GTQTSTextures.ELEVATOR_CASING;
    }

    @SideOnly(Side.CLIENT)

    @Override
    protected ICubeRenderer getFrontOverlay() {
        return Textures.DATA_BANK_OVERLAY;
    }

    @Override
    protected void formStructure(PatternMatchContext context) {
        super.formStructure(context);
        initializeAbilities();
        Object motorTier = context.get("SpaceElevatorTieredStats");
        this.motorTier = GTQTSUtil.getOrDefault(() -> motorTier instanceof WrappedIntTired,
                () -> ((WrappedIntTired) motorTier).getIntTier(),
                0);

        for (ISpaceElevatorProvider receiver : getSpaceElevatorProviders()) {
            if (receiver.getModule() != null && receiver.getModule().isStructureFormed())
                this.spaceElevatorReceivers.add(receiver.getModule().getSpaceElevatorReceiver());
        }

    }

    @Override
    public void checkStructurePattern() {
        if (this.getOffsetTimer() % 100 == 0 || this.isFirstTick()) {
            if (!this.isStructureFormed()) {
                reinitializeStructurePattern();
            }
            super.checkStructurePattern();
        }
    }

    @Override
    public void invalidateStructure() {
        super.invalidateStructure();
        resetTileAbilities();
    }

    protected void initializeAbilities() {
        List<IEnergyContainer> powerInput = new ArrayList<>(getAbilities(MultiblockAbility.INPUT_ENERGY));
        powerInput.addAll(getAbilities(MultiblockAbility.INPUT_LASER));
        this.energyContainer = new EnergyContainerList(powerInput);

        List<IOpticalComputationHatch> providers = getAbilities(MultiblockAbility.COMPUTATION_DATA_RECEPTION);
        if (providers != null && !providers.isEmpty()) {
            this.computationProvider = providers.get(0);
        }
    }


    private void resetTileAbilities() {
        this.energyContainer = new EnergyContainerList(new ArrayList<>());
    }


    @Override
    protected ModularUI createUI(EntityPlayer entityPlayer) {
        return createUITemplate(entityPlayer).build(getHolder(), entityPlayer);
    }

    public List<ISpaceElevatorProvider> getSpaceElevatorProviders() {
        return this.getAbilities(GTQTSMultiblockAbility.SpaceElevatorProvider_MULTIBLOCK_ABILITY);
    }

    protected ModularUI.Builder createUITemplate(EntityPlayer entityPlayer) {
        ModularUI.Builder builder = ModularUI.builder(GuiTextures.BACKGROUND, 198, 238);

        // Display
        builder.image(4, 4, 190, 139, GuiTextures.DISPLAY);


        builder.label(9, 9, getMetaFullName(), 0xFFFFFF);

        builder.widget(new AdvancedTextWidget(9, 20, this::addDisplayText, 0xFFFFFF)
                .setMaxWidthLimit(220)
                .setClickHandler(this::handleDisplayClick));


        builder.widget(new ClickButtonWidget(173, 155, 18, 18, "", data -> transport(entityPlayer))
                .setButtonTexture(GTQTSTextures.BUTTON_DISABLE_STATIC)
                .setTooltipText("空间站折跃"));

        // Extend Button
        builder.widget(new ImageCycleButtonWidget(173, 213, 18, 18, GTQTSTextures.BUTTON_ELEVATOR_EXTENSION,
                this::isExtended, this::setExtended).setTooltipHoverString("gtqtspace.gui.multiblock.space_elevator_extended"));
        builder.widget(new ImageWidget(173, 201, 18, 6, GuiTextures.BUTTON_POWER_DETAIL));

        // Voiding Mode Button
        builder.widget(new ClickButtonWidget(173, 173, 18, 18, "", data -> enableAllModules())
                .setButtonTexture(GTQTSTextures.BUTTON_ENABLE_STATIC)
                .setTooltipText("gtqtspace.gui.multiblock.space_elevator.enable_all_modules"));

        builder.widget(new ClickButtonWidget(173, 191, 18, 18, "", data -> disableAllModules())
                .setButtonTexture(GTQTSTextures.BUTTON_DISABLE_STATIC)
                .setTooltipText("gtqtspace.gui.multiblock.space_elevator.disable_all_modules"));


        builder.bindPlayerInventory(entityPlayer.inventory, 155);
        return builder;
    }

    private void transport(EntityPlayer entityPlayer) {

        FMLCommonHandler.instance().getMinecraftServerInstance().getPlayerList().transferPlayerToDimension((EntityPlayerMP) entityPlayer, 50, new WorldTeleporter(entityPlayer.getServer().getWorld(50), getPos()));
    }

    @Override
    protected void addDisplayText(List<ITextComponent> textList) {

        MultiblockDisplayText.builder(textList, this.isStructureFormed())
                .addCustom(tl -> {
                    if (this.isStructureFormed()) {
                        tl.add(TextComponentUtil.translationWithColor(TextFormatting.BLUE, "gtqtspace.machine.space_elevator.motor_tier", this.motorTier));
                        tl.add(TextComponentUtil.translationWithColor(TextFormatting.YELLOW, "gtqtspace.machine.space_elevator.max_modules", getMaxModules()));

                        if (this.spaceElevatorReceivers.isEmpty()) {
                            tl.add(TextComponentUtil.translationWithColor(TextFormatting.RED, "gtqtspace.machine.space_elevator.modules.none"));
                        } else {
                            tl.add(TextComponentUtil.translationWithColor(getModuleCount() < getMaxModules() ? TextFormatting.AQUA : TextFormatting.YELLOW, "gtqtspace.machine.space_elevator.total_modules", getModuleCount()));

                            tl.add(TextComponentUtil.translationWithColor(TextFormatting.GREEN, "gtqtspace.machine.space_elevator.modules"));

                            List<String> moduleNames = new ArrayList<>();
                            List<String> uniqueNames = new ArrayList<>();
                            this.spaceElevatorReceivers.forEach(s -> {
                                moduleNames.add(s.getNameForDisplayCount());
                                if (!uniqueNames.contains(moduleNames.get(moduleNames.indexOf(s.getNameForDisplayCount())))) {
                                    uniqueNames.add(s.getNameForDisplayCount());
                                }
                            });
                            uniqueNames.forEach(s -> tl.add(TextComponentUtil.translationWithColor(TextFormatting.WHITE, s, Collections.frequency(moduleNames, s))));
                        }
                    }
                });


    }
    private int getModuleCount() {
        return this.spaceElevatorReceivers.size();
    }

    private boolean isExtended() {
        return this.isExtended;
    }

    private void setExtended(boolean bool) {
        this.isExtended = bool;
        this.spaceElevatorReceivers.forEach(s -> s.setSpaceElevator(null));
        reinitializeStructurePattern();
    }

    @Override
    public NBTTagCompound writeToNBT(NBTTagCompound data) {
        data.setBoolean("extended", this.isExtended);
        return super.writeToNBT(data);
    }

    @Override
    public void readFromNBT(NBTTagCompound data) {
        super.readFromNBT(data);
        this.isExtended = data.getBoolean("extended");
    }

    @Override
    public void writeInitialSyncData(PacketBuffer buf) {
        super.writeInitialSyncData(buf);
        buf.writeBoolean(this.isExtended);
    }

    @Override
    public void receiveInitialSyncData(PacketBuffer buf) {
        super.receiveInitialSyncData(buf);
        this.isExtended = buf.readBoolean();
    }

    public int getMotorTier() {
        return this.motorTier;
    }

    public IEnergyContainer getEnergyContainerForModules() {
        return this.energyContainer;
    }

    private void disableAllModules() {
        getSpaceElevatorProviders().forEach(ISpaceElevatorProvider::sentWorkingDisabled);
    }

    private void enableAllModules() {
        getSpaceElevatorProviders().forEach(ISpaceElevatorProvider::sentWorkingEnabled);
    }

    public IOpticalComputationProvider getComputationProvider() {
        return this.computationProvider;
    }

    @Override
    public void addInformation(ItemStack stack, World world, @Nonnull List<String> tooltip, boolean advanced) {
        super.addInformation(stack, world, tooltip, advanced);
        tooltip.add(TooltipHelper.RAINBOW_SLOW + I18n.format("流浪地球计划", new Object[0]));
        tooltip.add(I18n.format("拓展模式：请在UI内打开拓展模式，shift右键控制器即可预览结构"));
        tooltip.add(I18n.format("跃迁模式：可将玩家传送至空间站"));
        tooltip.add(I18n.format("最多能装备12个太空电梯模块，拓展模式下最多支持24个模块"));
        tooltip.add(I18n.format("最大能装备的电梯模块与磁轨加速器等级正相关，升级磁轨加速器解锁更多槽位"));
        tooltip.add(I18n.format("可将本体的能量，算力供所有模块共享"));
        tooltip.add(I18n.format("升级磁轨加速器为模块提供升级"));
    }

    @SideOnly(Side.CLIENT)
    @Override
    public void renderMetaTileEntity(CCRenderState renderState, Matrix4 translation, IVertexOperation[] pipeline) {
        super.renderMetaTileEntity(renderState, translation, pipeline);
        this.getFrontOverlay().renderOrientedState(renderState, translation, pipeline, getFrontFacing(), true,
                isStructureFormed());
    }
    private boolean checkModules() {
        return getModuleCount() <= getMaxModules();
    }

    private int getMaxModules() {
        if (this.motorTier == 1)
            return 6;
        if (this.motorTier == 2)
            return 12;
        if (this.motorTier == 3 && this.isExtended)
            return 15;
        if (this.motorTier == 4 && this.isExtended)
            return 18;
        if (this.motorTier == 5 && this.isExtended)
            return 24;

        return 12;
    }
    @Override
    public boolean usesMui2() {
        return false;
    }
}

